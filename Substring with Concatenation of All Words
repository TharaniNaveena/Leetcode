class Solution:
    def findSubstring(self, s: str, words: List[str]) -> List[int]:
        from collections import Counter

        freq = Counter(words)
        l_words = len(words)  # number of words
        l_word = len(words[0])  # length of each word

        res = []
        for shift in range(l_word):
            current_freq = Counter()
            # Walk through s in strides of l_word, starting at 'shift'
            for i in range(shift, len(s) - l_word + 1, l_word):
                # Add the new trailing word to the window counter
                w = s[i:i+l_word]
                current_freq[w] += 1
                # If window size exceeds the number of words, remove the oldest word
                if current_freq.total() > l_words:
                    left_start = i - l_words * l_word
                    old_w = s[left_start:left_start + l_word]
                    current_freq[old_w] -= 1
                # check for potential solution
                if current_freq == freq:
                    res.append(i - l_word * (l_words - 1))
        return res
